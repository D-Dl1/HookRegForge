# 行号功能特性说明

## 🎯 新增功能

为了解决代码错误定位困难的问题，我已经为代码输入区域添加了完整的行号显示和错误定位功能。

## ✨ 功能特性

### 1. **行号显示**
- 左侧显示行号列
- 自动同步滚动
- 等宽字体确保对齐
- 视觉上与代码区分开

### 2. **错误定位**
- 解析错误时自动提取行号
- 在错误消息中显示具体行号
- 自动跳转并高亮错误行
- 支持多种错误格式识别

### 3. **代码编辑增强**
- **Tab缩进**: Tab键添加4空格缩进
- **Shift+Tab取消缩进**: 减少缩进级别
- **自动缩进**: Enter键后自动匹配上一行缩进
- **智能缩进**: 识别`{`后自动增加缩进

### 4. **跳转功能**
- "跳转到行"按钮
- 显示当前光标位置
- 显示总行数
- 输入验证和错误提示

## 🎮 使用方法

### 基本操作
1. **查看行号**: 代码左侧自动显示行号
2. **跳转到行**: 点击"跳转到行"按钮，输入目标行号
3. **错误定位**: 出现语法错误时，自动跳转到错误行并高亮显示

### 键盘快捷键
- `Tab`: 增加缩进（4个空格）
- `Shift + Tab`: 减少缩进
- `Enter`: 自动缩进到合适位置

### 错误定位
当代码解析失败时：
1. 错误消息会显示具体行号，如："代码解析失败: Unexpected token (行 15)"
2. 自动跳转到错误行
3. 错误行会有红色背景高亮（2秒后消失）

## 🔧 技术实现

### 行号同步
```javascript
// 自动更新行号
textarea.addEventListener('input', () => updateLineNumbers());
textarea.addEventListener('scroll', () => syncScroll());
```

### 错误行号提取
支持识别多种错误格式：
- `line 5`
- `行 5`  
- `第 5 行`
- `position 1:5`
- `(5:10)`
- `at line 5`
- `on line 5`

### 智能缩进
- 检测上一行缩进级别
- 识别代码块开始（`{`）
- 自动匹配缩进深度

## 📋 功能演示

### 示例1: 语法错误定位
```javascript
function test() {
    console.log("hello"
    // 缺少闭合括号，错误会定位到第2行
}
```

### 示例2: 自动缩进
输入以下代码时会自动缩进：
```javascript
if (condition) {
    // 自动缩进4个空格
    console.log("test");
}
```

### 示例3: 跳转功能
- 点击"跳转到行"按钮
- 输入行号（如：25）
- 自动跳转到第25行并聚焦

## 🎨 视觉效果

### 行号区域
- 深色背景 (`#282c34`)
- 灰色文字 (`#6c7086`)
- 右对齐显示
- 最小宽度50px

### 错误高亮
- 红色半透明背景
- 2秒后自动消失
- 平滑过渡动画

### 焦点状态
- 整个编辑器区域有蓝色边框
- 阴影效果增强视觉反馈

## 🚀 性能优化

1. **防抖更新**: 避免频繁更新行号
2. **虚拟滚动**: 大文件时保持流畅
3. **智能重绘**: 只在必要时更新UI
4. **内存管理**: 及时清理事件监听器

## 🛠️ 兼容性

- ✅ Chrome 80+
- ✅ Firefox 75+  
- ✅ Safari 13+
- ✅ Edge 80+
- ✅ 移动端浏览器

## 📱 响应式设计

- 小屏幕设备自动调整行号宽度
- 触摸设备优化滚动体验
- 保持代码可读性

## 🔍 调试功能

开发者可以通过以下方式调试：

```javascript
// 获取当前行号
const currentLine = hookRegForge.lineNumbers.getCurrentLineNumber();

// 跳转到指定行
hookRegForge.lineNumbers.goToLine(25);

// 高亮错误行
hookRegForge.lineNumbers.highlightLine(10);
```

现在你可以：
1. **精确定位错误** - 看到具体在哪一行出错
2. **快速导航** - 使用跳转功能快速到达指定行
3. **更好的编辑体验** - 智能缩进和格式化
4. **专业的代码环境** - 类似IDE的行号显示

这大大改善了代码编辑和错误调试的体验！