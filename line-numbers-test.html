<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡Œå·åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { padding: 2rem; }
        .test-container { max-width: 800px; margin: 0 auto; }
        .test-section { margin: 2rem 0; }
        .btn { margin: 0.5rem; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª è¡Œå·åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>ä»£ç ç¼–è¾‘å™¨</h2>
            <div class="editor-container">
                <div class="code-editor">
                    <div class="line-numbers" id="line-numbers"></div>
                    <textarea id="code-textarea" class="code-input" placeholder="åœ¨è¿™é‡Œè¾“å…¥ä»£ç è¿›è¡Œæµ‹è¯•...

å°è¯•ä»¥ä¸‹æ“ä½œï¼š
1. è¾“å…¥å¤šè¡Œä»£ç 
2. ä½¿ç”¨Tabé”®ç¼©è¿›
3. æ»šåŠ¨æŸ¥çœ‹åŒæ­¥æ•ˆæœ
4. æµ‹è¯•è·³è½¬åŠŸèƒ½"></textarea>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•æ“ä½œ</h2>
            <button class="btn btn-primary" onclick="testGoToLine()">è·³è½¬åˆ°è¡Œ5</button>
            <button class="btn btn-primary" onclick="testHighlight()">é«˜äº®è¡Œ3</button>
            <button class="btn btn-secondary" onclick="addTestCode()">æ·»åŠ æµ‹è¯•ä»£ç </button>
            <button class="btn btn-secondary" onclick="clearCode()">æ¸…ç©ºä»£ç </button>
            <button class="btn btn-secondary" onclick="showInfo()">æ˜¾ç¤ºä¿¡æ¯</button>
        </div>
        
        <div class="test-section">
            <h2>æµ‹è¯•ç»“æœ</h2>
            <div id="test-results" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; font-family: monospace;">
                ç­‰å¾…æµ‹è¯•...
            </div>
        </div>
    </div>

    <script type="module">
        import { LineNumbers } from './js/ui/line-numbers.js';
        
        let lineNumbers;
        
        // åˆå§‹åŒ–
        try {
            lineNumbers = new LineNumbers('code-textarea', 'line-numbers');
            updateResults('âœ… è¡Œå·åŠŸèƒ½åˆå§‹åŒ–æˆåŠŸ');
        } catch (error) {
            updateResults('âŒ åˆå§‹åŒ–å¤±è´¥: ' + error.message);
        }
        
        // æµ‹è¯•å‡½æ•°
        window.testGoToLine = function() {
            if (lineNumbers) {
                const success = lineNumbers.goToLine(5);
                updateResults(success ? 'âœ… è·³è½¬åˆ°ç¬¬5è¡ŒæˆåŠŸ' : 'âŒ è·³è½¬å¤±è´¥');
            }
        };
        
        window.testHighlight = function() {
            if (lineNumbers) {
                lineNumbers.highlightLine(3);
                updateResults('âœ… é«˜äº®ç¬¬3è¡Œ');
            }
        };
        
        window.addTestCode = function() {
            const textarea = document.getElementById('code-textarea');
            textarea.value = `function testFunction() {
    console.log("ç¬¬2è¡Œ");
    if (true) {
        console.log("ç¬¬4è¡Œ");
        for (let i = 0; i < 10; i++) {
            console.log("ç¬¬6è¡Œ: " + i);
        }
    }
    return "ç¬¬9è¡Œ";
}

// ç¬¬11è¡Œæ³¨é‡Š
const obj = {
    method: function() {
        console.log("ç¬¬14è¡Œ");
    }
};

obj.method();`;
            
            // æ‰‹åŠ¨è§¦å‘æ›´æ–°
            textarea.dispatchEvent(new Event('input'));
            updateResults('âœ… æµ‹è¯•ä»£ç å·²æ·»åŠ ');
        };
        
        window.clearCode = function() {
            const textarea = document.getElementById('code-textarea');
            textarea.value = '';
            textarea.dispatchEvent(new Event('input'));
            updateResults('âœ… ä»£ç å·²æ¸…ç©º');
        };
        
        window.showInfo = function() {
            if (lineNumbers) {
                const currentLine = lineNumbers.getCurrentLineNumber();
                const totalLines = lineNumbers.getLineCount();
                updateResults(`ğŸ“Š å½“å‰è¡Œ: ${currentLine}, æ€»è¡Œæ•°: ${totalLines}`);
            }
        };
        
        function updateResults(message) {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `[${timestamp}] ${message}<br>`;
            results.scrollTop = results.scrollHeight;
        }
        
        // ç›‘å¬ç¼–è¾‘å™¨äº‹ä»¶
        const textarea = document.getElementById('code-textarea');
        textarea.addEventListener('input', () => {
            if (lineNumbers) {
                const totalLines = lineNumbers.getLineCount();
                updateResults(`ğŸ“ å†…å®¹å˜åŒ–ï¼Œå½“å‰æ€»è¡Œæ•°: ${totalLines}`);
            }
        });
        
        textarea.addEventListener('scroll', () => {
            updateResults(`ğŸ“œ æ»šåŠ¨ä½ç½®: ${textarea.scrollTop}px`);
        });
    </script>
</body>
</html>