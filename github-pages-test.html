<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Pages CDNæµ‹è¯• - HookRegForge</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0f1419;
            color: #e6e6e6;
            padding: 2rem;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-card {
            background: #1a1f25;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid #3c4043;
        }
        .status-loading {
            color: #e5c07b;
        }
        .status-success {
            color: #98c379;
        }
        .status-error {
            color: #e06c75;
        }
        .btn {
            background: #61dafb;
            color: #0f1419;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        .btn:hover {
            background: #4fa8c5;
        }
        pre {
            background: #282c34;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” GitHub Pages CDNæµ‹è¯•</h1>
        <p>ä¸“é—¨é’ˆå¯¹GitHub Pagesç¯å¢ƒçš„CDNåŠ è½½æµ‹è¯•</p>
        
        <div class="test-card">
            <h2>ç¯å¢ƒæ£€æµ‹</h2>
            <div id="environment-info">æ£€æµ‹ä¸­...</div>
        </div>
        
        <div class="test-card">
            <h2>CDNæµ‹è¯•ç»“æœ</h2>
            <div id="cdn-results">å‡†å¤‡æµ‹è¯•...</div>
        </div>
        
        <div class="test-card">
            <h2>EsprimaåŠ è½½çŠ¶æ€</h2>
            <div id="esprima-status">æœªåŠ è½½</div>
            <button class="btn" onclick="testEsprima()">æµ‹è¯•Esprima</button>
        </div>
        
        <div class="test-card">
            <h2>è§£å†³æ–¹æ¡ˆ</h2>
            <div id="solutions">
                <h3>GitHub Pagesç‰¹æœ‰é—®é¢˜è§£å†³æ–¹æ¡ˆï¼š</h3>
                <ul>
                    <li><strong>HTTPSæ··åˆå†…å®¹ï¼š</strong>ç¡®ä¿æ‰€æœ‰CDNé“¾æ¥éƒ½ä½¿ç”¨HTTPS</li>
                    <li><strong>ä»“åº“è®¾ç½®ï¼š</strong>åœ¨GitHubä»“åº“è®¾ç½®ä¸­å¯ç”¨"Enforce HTTPS"</li>
                    <li><strong>ç¼“å­˜é—®é¢˜ï¼š</strong>GitHub Pagesæœ‰ç¼“å­˜å»¶è¿Ÿï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿ</li>
                    <li><strong>Content-Typeï¼š</strong>æŸäº›CDNåœ¨GitHub Pagesä¸Šå¯èƒ½æœ‰å¤´éƒ¨é—®é¢˜</li>
                </ul>
                <button class="btn" onclick="window.open('https://github.com/settings/pages', '_blank')">
                    æ‰“å¼€GitHub Pagesè®¾ç½®
                </button>
            </div>
        </div>
    </div>

    <script>
        // æ£€æµ‹ç¯å¢ƒä¿¡æ¯
        function detectEnvironment() {
            const info = {
                isGitHubPages: window.location.hostname.includes('github.io'),
                protocol: window.location.protocol,
                hostname: window.location.hostname,
                userAgent: navigator.userAgent,
                isSecure: window.location.protocol === 'https:',
                hasServiceWorker: 'serviceWorker' in navigator,
                cookiesEnabled: navigator.cookieEnabled
            };
            
            const envDiv = document.getElementById('environment-info');
            envDiv.innerHTML = `
                <div class="${info.isGitHubPages ? 'status-success' : 'status-error'}">
                    <strong>GitHub Pages:</strong> ${info.isGitHubPages ? 'æ˜¯' : 'å¦'}
                </div>
                <div class="${info.isSecure ? 'status-success' : 'status-error'}">
                    <strong>åè®®:</strong> ${info.protocol}
                </div>
                <div><strong>åŸŸå:</strong> ${info.hostname}</div>
                <div><strong>æµè§ˆå™¨:</strong> ${navigator.userAgent.split(' ')[0]}</div>
            `;
            
            return info;
        }
        
        // æµ‹è¯•CDN
        async function testCDNs() {
            const cdns = [
                'https://cdnjs.cloudflare.com/ajax/libs/esprima/4.0.1/esprima.min.js',
                'https://unpkg.com/esprima@4.0.1/dist/esprima.min.js',
                'https://cdn.jsdelivr.net/npm/esprima@4.0.1/dist/esprima.min.js'
            ];
            
            const resultsDiv = document.getElementById('cdn-results');
            resultsDiv.innerHTML = '<div class="status-loading">æµ‹è¯•ä¸­...</div>';
            
            let results = [];
            
            for (let i = 0; i < cdns.length; i++) {
                const cdn = cdns[i];
                const startTime = Date.now();
                
                try {
                    const response = await fetch(cdn, { method: 'HEAD' });
                    const endTime = Date.now();
                    const responseTime = endTime - startTime;
                    
                    results.push({
                        url: cdn,
                        success: response.ok,
                        status: response.status,
                        responseTime: responseTime,
                        contentType: response.headers.get('content-type')
                    });
                } catch (error) {
                    results.push({
                        url: cdn,
                        success: false,
                        error: error.message,
                        responseTime: null
                    });
                }
            }
            
            // æ˜¾ç¤ºç»“æœ
            const resultHTML = results.map(result => `
                <div style="margin: 0.5rem 0; padding: 0.5rem; border-radius: 6px; background: rgba(255,255,255,0.05);">
                    <div class="${result.success ? 'status-success' : 'status-error'}">
                        ${result.success ? 'âœ…' : 'âŒ'} ${new URL(result.url).hostname}
                    </div>
                    <div style="font-size: 0.9rem; color: #abb2bf;">
                        ${result.success ? 
                            `çŠ¶æ€: ${result.status} | å“åº”æ—¶é—´: ${result.responseTime}ms | Content-Type: ${result.contentType}` :
                            `é”™è¯¯: ${result.error || 'ç½‘ç»œé”™è¯¯'}`
                        }
                    </div>
                </div>
            `).join('');
            
            resultsDiv.innerHTML = resultHTML;
            
            return results;
        }
        
        // æµ‹è¯•Esprima
        function testEsprima() {
            const statusDiv = document.getElementById('esprima-status');
            statusDiv.innerHTML = '<div class="status-loading">æµ‹è¯•ä¸­...</div>';
            
            // åˆ›å»ºæµ‹è¯•è„šæœ¬
            const script = document.createElement('script');
            script.onload = function() {
                if (typeof esprima !== 'undefined') {
                    try {
                        const testCode = 'function test() { return "hello"; }';
                        const ast = esprima.parseScript(testCode);
                        statusDiv.innerHTML = `
                            <div class="status-success">âœ… EsprimaåŠ è½½æˆåŠŸï¼</div>
                            <div>ç‰ˆæœ¬: ${esprima.version || 'æœªçŸ¥'}</div>
                            <pre>${JSON.stringify(ast, null, 2).substring(0, 200)}...</pre>
                        `;
                    } catch (error) {
                        statusDiv.innerHTML = `
                            <div class="status-error">âŒ EsprimaåŠ è½½ä½†è§£æå¤±è´¥</div>
                            <div>é”™è¯¯: ${error.message}</div>
                        `;
                    }
                } else {
                    statusDiv.innerHTML = '<div class="status-error">âŒ Esprimaæœªå®šä¹‰</div>';
                }
            };
            
            script.onerror = function() {
                statusDiv.innerHTML = '<div class="status-error">âŒ Esprimaè„šæœ¬åŠ è½½å¤±è´¥</div>';
            };
            
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/esprima/4.0.1/esprima.min.js';
            document.head.appendChild(script);
        }
        
        // é¡µé¢åŠ è½½æ—¶è¿è¡Œæ£€æµ‹
        window.addEventListener('load', function() {
            detectEnvironment();
            testCDNs();
        });
    </script>
</body>
</html>